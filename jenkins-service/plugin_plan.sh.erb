pkg_name=jenkins-<%= @name %>
pkg_origin=qago
pkg_version="<%= @version %>"
pkg_description="Jenkins <%= @name %> plugin"
pkg_maintainer='QAGO Maintainers'
pkg_license=('LGPL-2.1')
pkg_upstream_url=""
pkg_source=_no_pkg_source_
pkg_shasum=_no_pkg_shasum_
pkg_deps=(
    core/jenkins/2.89.4/20180221042204
    core/wget/1.19.1/20171024102323
    core/netcat/0.7.1/20170514150813
    core/bash/4.3.42/20170513213519
    core/grep/2.22/20170513213444
    core/sed/4.2.2/20170513213123
    core/unzip/6.0/20170513215357
)

do_unpack() {
    return 0
}

do_verify() {
    return 0
}

do_prepare() {
    return 0
}

# do_clean() {
#     # Prevent rm -rf "$CACHE_PATH"
#     return 0
# }

_install_dependency() {
    local dep="${1}"
    if [[ -z "${NO_INSTALL_DEPS:-}" ]]; then
	$HAB_BIN pkg path "$dep" || $HAB_BIN install -u $HAB_BLDR_URL --channel $HAB_BLDR_CHANNEL "$dep" || {
		if [[ "$HAB_BLDR_CHANNEL" != "$FALLBACK_CHANNEL" ]]; then
		    build_line "Trying to install '$dep' from '$FALLBACK_CHANNEL'"
		    $HAB_BIN install -u $HAB_BLDR_URL --channel "$FALLBACK_CHANNEL" "$dep" || true
		fi
	    }
    fi
    return 0
}

do_download() {
    return 0
}

do_install() {
    mkdir -p $HAB_CACHE_SRC_PATH/$pkg_dirname/plugins
    bash $PLAN_CONTEXT/../../install_jenkins_plugin.sh -d $HAB_CACHE_SRC_PATH/$pkg_dirname/plugins <%= @name %>@<%= @version %>
    cp -r plugins $pkg_prefix/plugins
}

do_build() {
    return 0
}
